!function(t,e){"function"==typeof define&&define.amd?define("AutoSuggest",["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):t.AutoSuggest=e(t.jQuery||t.$)}(this,function(t){if(!t)throw new Error("AutoSuggest: dependencies not met - jQuery is not defined");var e={};e.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),e.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var n={noop:function(){},noopd:function(t){return t},ensure:function(t,e,n){[].concat(n).forEach(function(n){if(void 0===e[n])throw new Error("AutoSuggest: Missing required parameter, "+t+"."+n)})},ensureType:function(t,n,o,i){[].concat(n[o]).forEach(function(n){if((void 0===n?"undefined":e.typeof(n))!==i)throw new Error("AutoSuggest: Invalid Type for "+t+"."+o+", expected "+i)})},cloneStyle:function(e,n){var o=window.getComputedStyle(t(e)[0],null),i={};Array.prototype.forEach.call(o,function(t){i[t]=o.getPropertyValue(t)}),t(n).css(i)},getGlobalOffset:function(t){var e=t,n=0,o=0;do{n+=e.offsetLeft,o+=e.offsetTop}while(e=e.offsetParent);return{left:n,top:o}},getScrollLeftForInput:function(e){if(e.createTextRange){var n=e.createTextRange(),o=window.getComputedStyle(e,void 0),i=parseFloat(o.paddingLeft),s=n.getBoundingClientRect();return e.getBoundingClientRect().left+e.clientLeft+i-s.left}return t(e).scrollLeft()},getCursorPosition:function(t){var e=0;if(void 0!==t.selectionDirection)e="backward"==t.selectionDirection?t.selectionStart:t.selectionEnd;else if(document.selection){t.focus();var n=document.selection.createRange();n.moveStart("character",-t.value.length),e=n.text.length}return e},htmlEncode:function(e){return t("<div/>").text(e).html()}},o=function(){function o(t,o){return[].concat(t).map(function(t){var i=void 0===t?"undefined":e.typeof(t);return"string"===i?(t={show:t,replaceWith:t,cursorPosition:[0,0]},o||(t.on=[t.show])):"object"===i&&(n.ensure("Suggestion",t,["show","replaceWith"]),n.ensureType("Suggestion",t,"show","string"),n.ensureType("Suggestion",t,"replaceWith","string"),t.cursorPosition=t.cursorPosition||[0,0],t.cursorPosition.constructor!==Array&&(t.cursorPosition=[t.cursorPosition,t.cursorPosition]),o||(n.ensure("Suggestion",t,"on"),n.ensureType("Suggestion",t,"on","string"),t.on=[].concat(t.on))),t})}var i={trigger:null,caseSensitive:!0};return function(e){e&&!e.suggestions&&(e={suggestions:e}),e=t.extend(!0,{},i,e||{}),n.ensure("SuggestionList",e,"suggestions"),"function"==typeof e.suggestions?this.getSuggestions=function(t,n){e.suggestions(t,function(t){return n(o(t,!0))})}:e.suggestions.constructor!==Array&&"string"!=typeof e.suggestions||(e.suggestions=o(e.suggestions),this.getSuggestions=function(t,n){var o=new RegExp(t,e.caseSensitive?"":"i");n(e.suggestions.filter(function(t){for(var e=!1,n=0;n<t.on.length&&!(e=o.test(t.on[n]));n++);return e}))});var s=e.trigger;if(s&&"string"!=typeof s)throw new Error("AutoSuggest: Invalid Type, SuggestionList.trigger should be a string");if(s){var r="\\"+s.split("").join("\\");this.regex=new RegExp("(?:^|[^"+r+"]+)"+r+"(\\S*)$")}else this.regex=new RegExp("(?:^|\\W+)(\\w+)$");this.trigger=s}}(),i=function(){function n(o){e.classCallCheck(this,n),this.width=0,this.hidden=!0,this.dropdownContent=t('<ul class="dropdown-menu dropdown-menu-left"></ul>'),this.dropdown=t('<div class="dropdown open as-dropdown" style="display:none; position: absolute;"></div>'),t("body").append(this.dropdown.append(this.dropdownContent)),this.hide()}return e.createClass(n,[{key:"show",value:function(e){e&&(this.dropdown[0].style.left=e.left+"px",this.dropdown[0].style.top=e.top+"px",e.left+this.width>t("body").width()?this.dropdown.find(".dropdown-menu").removeClass("dropdown-menu-left").addClass("dropdown-menu-right"):this.dropdown.find(".dropdown-menu").removeClass("dropdown-menu-right").addClass("dropdown-menu-left")),this.dropdown.find("li").removeClass("active"),this.dropdown.find("li:first-child").addClass("active"),this.dropdown.show(),this.hidden=!1}},{key:"hide",value:function(){this.dropdown.hide(),this.hidden=!0}},{key:"setWidth",value:function(){this.width=this.dropdownContent.width()}},{key:"fill",value:function(e,n){var o=this;this.dropdownContent.empty(),e.forEach(function(e){var i=t("<li><a>"+e.show+"</a></li>");i.data("as-linkcontent",e),i.mousedown(function(){return n(e),o.hide(),!1}),o.dropdownContent.append(i)}),this.hidden?(this.show(),this.setWidth(),this.hide()):this.setWidth()}},{key:"getValue",value:function(){return this.dropdown.find("li.active").data("as-linkcontent")}},{key:"next",value:function(){var t=this.dropdown.find("li.active"),e=t.next();return t.removeClass("active"),e.length?e.addClass("active"):this.dropdown.find("li:first-child").addClass("active"),this.getValue()}},{key:"prev",value:function(){var t=this.dropdown.find("li.active"),e=t.prev();return t.removeClass("active"),e.length?e.addClass("active"):this.dropdown.find("li:last-child").addClass("active"),this.getValue()}}]),n}();return function(){function s(t,e,n){n.forEach(function(n){void 0!==e[n]&&void 0===t[n]&&(t[n]=e[n])})}var r={suggestions:[]},a=function(){function a(n,u){e.classCallCheck(this,a),n=t.extend(!0,{},r,n||{}),this.isActive=!1,this.activeElement=null,this.activeElementCursorPosition=0,this.activeSuggestionList=null,this.dropdown=new i,this.suggestionLists=[].concat(n.suggestions);for(var l=0;l<this.suggestionLists.length;l++){var d=this.suggestionLists[l];if(!d)throw new Error("AutoSuggest: invalid suggestion list passed");d instanceof o||(d.suggestions||(d={suggestions:d}),s(d,n,["caseSensitive","trigger"]),this.suggestionLists[l]=new o(d))}u&&this.addInputs(u)}return e.createClass(a,[{key:"addInputs",value:function(e){var o=this;(e=t(e)).each(function(){var e=t(this);if(this.isContentEditable)e.data("as-isinput",!1);else{if(!e.is("input[type = text],textarea"))throw new Error("AutoSuggest: Invalid input: only input[type = text], textarea and contenteditable elements are supported");e.data("as-isinput",!0)}}),e.on("input",function(){var e=t(this),i=e.val();if(e.data("as-isinput")){var s=n.getCursorPosition(this);o.activeElementCursorPosition=s,i=i.slice(0,s)}o.isActive=!1;var r=function(s){if(s.regex.test(i)){o.activeSuggestionList=s;var r=i.match(s.regex)[1];return s.getSuggestions(r,function(i){i.length?(o.isActive=!0,o.dropdown.fill(i,function(t){return o.setValue(t,s)}),o.dropdown.show(function(e){if(e.data("as-isinput")){var o=e.val(),i=n.getCursorPosition(e[0]),s=o.slice(0,i);t(".as-positionclone").remove();var r=t('<div class="as-positionclone"/>'),a=t('<div style="display:inline-block;">'+n.htmlEncode(s.slice(0,-1))+'<span id="as-positioner">'+n.htmlEncode(s.slice(-1))+"</span>"+n.htmlEncode(o.slice(i))+"</div>");r.append(a),n.cloneStyle(e[0],r[0]);var u=n.getGlobalOffset(e[0]);r.css({position:"absolute",opacity:0,left:u.left+"px",top:u.top+"px"}),t("body").append(r),e.is("input")?(r.css({overflowX:"auto",whiteSpace:"nowrap"}),i===o.length?r.scrollLeft(a.width()):r.scrollLeft(Math.min(n.getScrollLeftForInput(e[0]),a.width()))):(a.css("max-width","100%"),r.scrollLeft(e.scrollLeft()),r.scrollTop(e.scrollTop()));var l=n.getGlobalOffset(t("#as-positioner")[0]);return l.left+=10-r.scrollLeft(),l.top+=28-r.scrollTop(),r.remove(),l}}(e))):o.dropdown.hide()}),"break"}},a=!0,u=!1,l=void 0;try{for(var d,c=o.suggestionLists[Symbol.iterator]();!(a=(d=c.next()).done);a=!0){if("break"===r(d.value))break}}catch(t){u=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(u)throw l}}o.isActive||o.dropdown.hide()}),e.keydown(function(t,e){if(o.isActive){var n=e||t;if(13===n.keyCode||9===n.keyCode)o.setValue(o.dropdown.getValue(),o.activeSuggestionList),o.dropdown.hide();else if(40==n.keyCode)o.dropdown.next();else{if(38!=n.keyCode)return!0;o.dropdown.prev()}n.preventDefault(),t.stopImmediatePropagation()}}),e.blur(function(){o.activeElement=null,o.isActive=!1,o.dropdown.hide()}).focus(function(){o.activeElement=t(this)})}},{key:"setValue",value:function(t,e){var n=this.activeElement,o=t.replaceWith;if(n&&n.data("as-isinput")){var i=n.val(),s=this.activeElementCursorPosition,r=i.slice(0,s),a=r.split(e.trigger||/\W/).pop(),u=(r=r.slice(0,0-a.length-(e.trigger||"").length)).length;n.val(r+o+i.slice(s)),n.focus();var l=t.cursorPosition,d=u+o.length,c=d+l[0],f=d+l[1];n[0].setSelectionRange(c,f)}this.isActive=!1}}]),a}();t.fn.autoSuggest=function(t){return t instanceof a?(t.addInputs(this),t):new a(t,this)};return a}()});